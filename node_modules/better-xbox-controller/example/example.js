// Generated by CoffeeScript 1.10.0
(function() {
  var USB, XBoxController, controller, device, stick;

  XBoxController = require('../src/controller');

  USB = require('usb');

  device = USB.findByIds(1118, 654);

  controller = new XBoxController(device);

  controller.on('button', function(key, val) {
    console.log(("Button " + key + " has been ") + (val ? 'pressed' : 'released'));
    if (val) {
      switch (key) {
        case 'a':
          return controller.setLed('LED_1');
        case 'b':
          return controller.setLed('LED_2');
        case 'y':
          return controller.setLed('LED_3');
        case 'x':
          return controller.setLed('LED_4');
        case 'xBox':
          return controller.setLed('ALTERNATING');
        case 'start':
          return controller.setLed('ROTATING');
        case 'back':
          return controller.setLed('BLINKING');
        default:
          return controller.setLed('ALL_OFF');
      }
    }
  });

  controller.on('trigger', function(val) {
    console.log("Trigger: right:" + val.r + "\tleft:" + val.l);
    return controller.setRumbler(val.l, val.r);
  });

  controller.dead = 10000;

  stick = function(side, val) {
    var angle, length;
    length = val.getLength().toFixed(2);
    angle = val.getAngle().toFixed(2);
    return console.log((side + " stick: {x:" + val.x + ",\ty:" + val.y + "};\t") + ("{l:" + length + ",\ta:" + angle + "Â°}"));
  };

  controller.on('stick:left', function(val) {
    return stick('left', val);
  });

  controller.on('stick:right', function(val) {
    return stick('right', val);
  });

  controller.on('error', function(err) {
    return console.error(err);
  });

  controller.open();

}).call(this);
